@model List<CartItem>

@{
    ViewData["Title"] = "Nhập địa chỉ giao hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
    decimal total = Model.Sum(item => item.Quantity * item.FoodItem.Price);
}

<div class="container mt-5">
    <h2 class="section-title text-primary">📦 Nhập thông tin giao hàng</h2>

    <form asp-action="DatHang" method="post">
        @Html.AntiForgeryToken()

        <div class="form-group">
            <label>👤 Họ tên người nhận</label>
            <input type="text" name="CustomerName" class="form-control" placeholder="Nguyễn Văn A" required />
        </div>

        <div class="form-group">
            <label>📍 Địa chỉ giao hàng</label>
            <input type="text" name="Address" class="form-control" placeholder="123 Đường ABC, Quận XYZ" required />
        </div>

        <div class="form-group">
            <label>📞 Số điện thoại</label>
            <input type="text" name="Phone" class="form-control" placeholder="0901234567" required />
        </div>
        <label for="DiscountCode">Mã giảm giá (tùy chọn):</label>
        <input type="text" name="DiscountCode" class="form-control" />

       
        <hr class="my-4" />

        <h4>🛒 Giỏ hàng</h4>
        <table class="table table-bordered table-hover" style="background-color: #fff;">
            <thead style="background-color: #cce5ff; color: #004085;">
                <tr>
                    <th>Món ăn</th>
                    <th>Số lượng</th>
                    <th>Đơn giá</th>
                    <th>Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr style="background-color: #fefefe;">
                        <td>@item.FoodItem.Name</td>
                        <td>@item.Quantity</td>
                        <td>@item.FoodItem.Price ₫</td>
                        <td>@(item.Quantity* item.FoodItem.Price) ₫</td>
                    </tr>
                }
            </tbody>
        </table>

        <p class="mt-3" style="font-size: 18px;">
            <strong>Tổng cộng:</strong>
            <span style="color: #d63384;">@total ₫</span>
        </p>

        <button type="submit" class="btn btn-primary mt-3 onsubmit="playTing()">✅ Đặt hàng</button>
        <a asp-action="Cart" class="btn btn-secondary mt-3 ml-2">🔙 Quay lại giỏ hàng</a>
    </form>

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger mt-4">
            @TempData["Error"]
        </div>
    }
    <audio id="ting-audio" src="~/audio/ting.mp3" preload="auto"></audio>
</div>
<script>
    function playTing() {
        const audio = document.getElementById("ting-audio");
        if (audio) {
            audio.play();
        }
    }
</script>
